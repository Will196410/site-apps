<script src="https://will196410.github.io/site-apps/loader.js?v=1"></script>

<!-- Optional: only keep deps here if multiple apps need them -->
<script>
  window.SiteApps && window.SiteApps.initAll && window.SiteApps.initAll();
</script>

<script>
(() => {
  "use strict";

  function setStatus(wrap, msg) {
    const status = wrap && wrap.querySelector(".copy-link-status");
    if (!status) return;
    status.textContent = msg;
    clearTimeout(status._t);
    status._t = setTimeout(() => (status.textContent = ""), 2000);
  }

  async function copyText(text) {
    if (navigator.clipboard && window.isSecureContext) {
      await navigator.clipboard.writeText(text);
      return true;
    }
    const ta = document.createElement("textarea");
    ta.value = text;
    ta.setAttribute("readonly", "");
    ta.style.position = "fixed";
    ta.style.top = "-9999px";
    document.body.appendChild(ta);
    ta.select();
    const ok = document.execCommand("copy");
    document.body.removeChild(ta);
    return ok;
  }

  document.addEventListener("click", async (e) => {
    const btn = e.target.closest(".copy-link-btn");
    if (!btn) return;

    const wrap = btn.closest(".copy-link-wrap");
    const url = window.location.href;

    try {
      await copyText(url);
      btn.classList.add("is-copied");
      setStatus(wrap, "Copied!");
      setTimeout(() => btn.classList.remove("is-copied"), 800);
    } catch {
      setStatus(wrap, "Couldn’t copy — please copy from the address bar.");
    }
  });
})();
</script>
